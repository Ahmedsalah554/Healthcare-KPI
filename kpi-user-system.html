<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุธุงู ุงููุณุชุฎุฏู - ุฅุฏุฎุงู ูุคุดุฑุงุช ุงูุฃุฏุงุก</title>
    
    <link rel="stylesheet" href="./css/variables.css">
    <link rel="stylesheet" href="./css/components.css">
    <link rel="stylesheet" href="./css/user-styles.css">
    <link rel="stylesheet" href="./css/charts.css">
</head>
<body>
    <!-- ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู -->
    <div id="loginPage" class="login-page">
        <div class="login-container">
            <div class="login-header">
                <div class="login-logo">๐ค</div>
                <h1>ูุธุงู ุงููุณุชุฎุฏู</h1>
                <p>ุฅุฏุฎุง๏ฟฝ๏ฟฝ ุจูุงูุงุช ูุคุดุฑุงุช ุงูุฃุฏุงุก</p>
            </div>

            <div class="login-error" id="loginError"></div>

            <form id="loginForm" class="login-form" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="loginEmail">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                    <input type="email" id="loginEmail" required placeholder="user@hospital.com" value="user@hospital.com">
                </div>

                <div class="form-group">
                    <label for="loginPassword">ูููุฉ ุงููุฑูุฑ</label>
                    <input type="password" id="loginPassword" required placeholder="โขโขโขโขโขโขโขโข" value="user123">
                </div>

                <div class="remember-forgot">
                    <label>
                        <input type="checkbox"> ุชุฐูุฑูู
                    </label>
                    <a href="#" onclick="alert('ูุฑุฌู ุงูุชูุงุตู ูุน ุงููุณุคูู')">ูุณูุช ูููุฉ ุงููุฑูุฑุ</a>
                </div>

                <button type="submit" class="btn btn-primary btn-block">
                    ๐ ุชุณุฌูู ุงูุฏุฎูู
                </button>
            </form>

            <div class="mt-2" style="text-align: center; color: #666; font-size: 0.9rem;">
                <p><strong>ููุชุฌุฑุจุฉ:</strong></p>
                <p>ุงูุจุฑูุฏ: user@hospital.com</p>
                <p>ูููุฉ ุงููุฑูุฑ: user123</p>
            </div>
        </div>
    </div>

    <!-- ุตูุญุฉ ุงูุชุทุจูู -->
    <div id="appPage" class="app-page">
        <!-- Header -->
        <header class="app-header">
            <h1>๐ ูุธุงู ุฅุฏุฎุงู ูุคุดุฑุงุช ุงูุฃุฏุงุก</h1>
            <div class="app-header-right">
                <div class="facility-badge" id="facilityNameDisplay">ุงูููุดุฃุฉ</div>
                <div class="user-badge" id="userNameDisplay">ุงููุณุชุฎุฏู</div>
                <button class="btn-logout" onclick="handleLogout()">
                    ๐ช ุฎุฑูุฌ
                </button>
            </div>
        </header>

        <!-- Content -->
        <div class="app-content">
            <!-- ูููุฐุฌ ุฅุฏุฎุงู ุงููุคุดุฑ -->
            <div id="kpiFormContainer" class="kpi-form-container">
                <div class="kpi-form">
                    <div class="kpi-form-header">
                        <h2 class="kpi-form-title" id="kpiFormTitle">ุงุฎุชุฑ ูุคุดุฑุงู ููุจุฏุก</h2>
                        <button class="btn-close-form" onclick="closeKPIForm()">ร</button>
                    </div>

                    <div id="formulaInfo"></div>

                    <form id="kpiDataForm" onsubmit="saveKPIData(event)">
                        <div class="input-row">
                            <div class="input-group">
                                <label for="kpiDate">ุงูุชุงุฑูุฎ *</label>
                                <input type="date" id="kpiDate" required>
                            </div>

                            <div class="input-group">
                                <label for="kpiPeriod">ุงููุชุฑุฉ *</label>
                                <select id="kpiPeriod" required>
                                    <option value="">-- ุงุฎุชุฑ ุงููุชุฑุฉ --</option>
                                    <option value="ุดูุฑู">ุดูุฑู</option>
                                    <option value="ุฑุจุน ุณููู">ุฑุจุน ุณููู</option>
                                    <option value="ูุตู ุณููู">ูุตู ุณููู</option>
                                    <option value="ุณููู">ุณููู</option>
                                </select>
                            </div>
                        </div>

                        <div class="input-row">
                            <div class="input-group">
                                <label id="numeratorLabel" for="kpiNumerator">ูููุฉ ุงูุจุณุท *</label>
                                <input type="number" id="kpiNumerator" step="0.01" required placeholder="0" oninput="calculateResult()">
                            </div>

                            <div class="input-group">
                                <label id="denominatorLabel" for="kpiDenominator">ูููุฉ ุงูููุงู *</label>
                                <input type="number" id="kpiDenominator" step="0.01" required placeholder="0" oninput="calculateResult()">
                            </div>
                        </div>

                        <div class="result-box" id="resultBox">
                            <div class="result-label">ุงููุชูุฌุฉ ุงููุญุณูุจุฉ</div>
                            <div class="result-value" id="resultValue">0.00%</div>
                        </div>

                        <div class="form-group">
                            <label for="kpiNotes">ููุงุญุธุงุช (ุงุฎุชูุงุฑู)</label>
                            <textarea id="kpiNotes" rows="3" placeholder="ุฃุถู ุฃู ููุงุญุธุงุช ููุง..."></textarea>
                        </div>

                        <div class="action-buttons">
                            <button type="submit" class="btn btn-primary">
                                ๐พ ุญูุธ ุงูุจูุงูุงุช
                            </button>
                            <button type="button" class="btn btn-reset" onclick="resetKPIForm()">
                                ๐ ุฅุนุงุฏุฉ ุชุนููู
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tabs-container">
                <div class="tabs">
                    <button class="tab-btn active" onclick="switchTab('kpiList')">
                        ๐ ูุงุฆูุฉ ุงููุคุดุฑุงุช
                    </button>
                    <button class="tab-btn" onclick="switchTab('dataHistory')">
                        ๐ ุงูุจูุงูุงุช ุงููุฏุฎูุฉ
                    </button>
                    <button class="tab-btn" onclick="switchTab('export')">
                        ๐ฅ ุงูุชุตุฏูุฑ
                    </button>
                </div>

                <!-- Tab 1: ูุงุฆูุฉ ุงููุคุดุฑุงุช -->
                <div id="kpiList" class="tab-content active">
                    <div class="kpi-list-header">
                        <h2>ุงุฎุชุฑ ุงููุคุดุฑ ูุฅุฏุฎุงู ุงูุจูุงูุงุช</h2>
                        <div class="kpi-search">
                            <input type="text" id="kpiSearch" placeholder="๐ ุงุจุญุซ ุนู ูุคุดุฑ..." oninput="filterKPIs()">
                        </div>
                    </div>

                    <div class="grid" id="kpiListContainer"></div>
                </div>

                <!-- Tab 2: ุงูุจูุงูุงุช ุงููุฏุฎูุฉ -->
                <div id="dataHistory" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">๐ ุงูุจูุงูุงุช ุงููุฏุฎูุฉ</div>
                            <button class="btn btn-danger btn-small" onclick="clearHistory()">
                                ๐๏ธ ูุณุญ ุงููู
                            </button>
                        </div>

                        <div class="empty-message" id="emptyMessage">
                            <div class="empty-icon">๐ญ</div>
                            <h3>ูุง ุชูุฌุฏ ุจูุงูุงุช</h3>
                            <p>ูู ุชูู ุจุฅุฏุฎุงู ุฃู ุจูุงูุงุช ุจุนุฏ</p>
                        </div>

                        <div class="data-table-container">
                            <table class="data-table" id="dataTable">
                                <thead>
                                    <tr>
                                        <th>ููุฏ ุงููุคุดุฑ</th>
                                        <th>ุงูุชุงุฑูุฎ</th>
                                        <th>ุงููุชุฑุฉ</th>
                                        <th>ุงูุจุณุท</th>
                                        <th>ุงูููุงู</th>
                                        <th>ุงููุชูุฌุฉ</th>
                                        <th>ุงูุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Tab 3: ุงูุชุตุฏูุฑ -->
                <div id="export" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">๐ฅ ุชุตุฏูุฑ ุงูุจูุงูุงุช</div>
                        </div>

                        <div class="export-stats">
                            <div class="stat-box">
                                <div class="stat-box-label">ุฅุฌูุงูู ุงูุณุฌูุงุช</div>
                                <div class="stat-box-value" id="statsCount">0</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-box-label">ุงูููุดุฃุฉ</div>
                                <div class="stat-box-value" id="statsFacility" style="font-size: 1.2rem;">-</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-box-label">ุขุฎุฑ ุฅุฏุฎุงู</div>
                                <div class="stat-box-value" id="statsDate" style="font-size: 1rem;">-</div>
                            </div>
                        </div>

                        <div class="export-buttons">
                            <button class="btn btn-success" onclick="exportToCSV()">
                                ๐ ุชุตุฏูุฑ CSV
                            </button>
                            <button class="btn btn-primary" onclick="exportToJSON()">
                                ๐ ุชุตุฏูุฑ JSON
                            </button>
                            <button class="btn btn-danger" onclick="printData()">
                                ๐จ๏ธ ุทุจุงุนุฉ
                            </button>
                        </div>

                        <div class="alert alert-info mt-3">
                            <span>๐ก</span>
                            <div>
                                <strong>ูุตูุญุฉ:</strong> ููููู ุชุตุฏูุฑ ุงูุจูุงูุงุช ุจุชูุณููุงุช ูุฎุชููุฉ ูุงุณุชุฎุฏุงููุง ูู ุงูุชูุงุฑูุฑ ุฃู ูุดุงุฑูุชูุง ูุน ูุฑููู.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.45.1/dist/apexcharts.min.js"></script>
    <script src="./js/utils.js"></script>
    <script src="./js/kpi-data.js"></script>
    <script src="./js/charts.js"></script>
    <script src="./js/user-main.js"></script>
</body>
</html>
